---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Navigation from '../../components/Navigation.astro';
import Card from '../../components/Card.astro';
import BackgroundCanvas from '../../components/BackgroundCanvas';
import LiteFooter from '../../components/LiteFooter.astro';

// Get all blog posts from content collection
const posts = await getCollection('blog');

// Sort by date, newest first
posts.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<Layout title="Blog" description="Technical insights on WordPress performance, Rust, WebAssembly, and modern web development. Deep dives from the Smooth Plugins engineering team.">
    <BackgroundCanvas client:only="react" />
    <div class="layout-container">
        <Navigation active="Blog" />
        
        <div class="blog-header">
            <h1>Engineering Blog</h1>
            <p>Deep dives into performance, Rust, and the future of the web.</p>
        </div>

        {posts.map((post) => (
            <Card
                title={post.data.title}
                kicker={post.data.date}
                variant={post.data.variant}
                span={post.data.span}
            >
                <p class="post-excerpt">{post.data.description}</p>
                <a href={`/blog/${post.slug}`} class="read-more">Read Entry â†’</a>
            </Card>
        ))}

        <LiteFooter />
    </div>
</Layout>

<style>
    .blog-header {
        grid-column: 1 / -1;
        padding: 40px 0;
    }

    .blog-header h1 {
        font-size: 48px;
        letter-spacing: -2px;
    }

    .blog-header p {
        font-size: 20px;
        opacity: 0.7;
        margin-top: 8px;
    }

    .post-excerpt {
        margin-top: 16px;
        font-size: 16px;
        line-height: 1.5;
        opacity: 0.8;
    }

    .read-more {
        display: inline-block;
        margin-top: 24px;
        font-weight: 600;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .read-more:hover {
        text-decoration: underline;
    }

    @media (max-width: 768px) {
        .blog-header {
            padding: 20px 0;
        }

        .blog-header h1 {
            font-size: 36px;
            letter-spacing: -1px;
        }

        .blog-header p {
            font-size: 18px;
        }
    }

    @media (max-width: 480px) {
        .blog-header {
            padding: 16px 0;
        }

        .blog-header h1 {
            font-size: 32px;
        }

        .blog-header p {
            font-size: 16px;
        }

        .post-excerpt {
            font-size: 15px;
        }

        .read-more {
            font-size: 13px;
        }
    }
</style>
